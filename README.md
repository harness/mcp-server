# Harness MCP Server (Rust)\n\nThe Harness MCP Server is a [Model Context Protocol (MCP)](https://modelcontextprotocol.io/introduction) server that provides seamless integration with Harness APIs, enabling advanced automation and interaction capabilities for developers and tools.\n\n**ü¶Ä This is the Rust implementation** - migrated from Go for improved performance, memory safety, and modern async capabilities.\n\n## Table of Contents\n\n- [Components](#components)\n  - [Tools](#tools)\n    - [Pipelines Toolset](#pipelines-toolset)\n    - [Pull Requests Toolset](#pull-requests-toolset)\n    - [Repositories Toolset](#repositories-toolset)\n    - [Registries Toolset](#registries-toolset)\n    - [Dashboards Toolset](#dashboards-toolset)\n    - [Cloud Cost Management Toolset](#cloud-cost-management-toolset)\n    - [Logs Toolset](#logs-toolset)\n- [Prerequisites](#prerequisites)\n- [Quickstart](#quickstart)\n- [Build from Source](#build-from-source)\n- [Use Docker Image](#use-docker-image)\n- [Integration with AI Assistants](#integration-with-ai-assistants)\n  - [Usage with Gemini CLI](#usage-with-gemini-cli)\n  - [Claude Desktop Configuration](#claude-desktop-configuration)\n  - [Usage with Claude Code](#usage-with-claude-code)\n  - [Usage with Windsurf](#usage-with-windsurf)\n  - [Usage with Amazon Q Developer CLI](#usage-with-amazon-q-developer-cli)\n  - [Cursor Configuration](#cursor-configuration)\n  - [VS Code Configuration](#vs-code-configuration)\n- [Development](#development)\n  - [Command Line Arguments](#command-line-arguments)\n  - [Environment Variables](#environment-variables)\n  - [Authentication](#authentication)\n- [Debugging](#debugging)\n- [Testing](#testing)\n\n## üöÄ What's New in Rust Version\n\n- **Performance**: Significantly faster startup and request processing\n- **Memory Safety**: Zero-cost abstractions with compile-time memory safety\n- **Async/Await**: Modern async runtime with Tokio for better concurrency\n- **Type Safety**: Strong typing with comprehensive error handling using Result types\n- **Resource Efficiency**: Lower memory footprint and CPU usage\n- **Cross-Platform**: Native compilation for multiple architectures\n\n## Components\n\n### Tools\n\nThe server implements several toolsets:\n\n#### Default Toolset\n\nThe default toolset contains essential tools from various services:\n\nToolset Name: `default`\n\n- `get_connector_details`: Get details of a specific connector\n- `list_connector_catalogue`: List the Harness connector catalogue\n- `list_connectors`: List connectors with filtering options\n- `list_pipelines`: List pipelines in a repository\n- `get_pipeline`: Get details of a specific pipeline\n- `get_execution`: Get details of a specific pipeline execution\n- `list_executions`: List pipeline executions\n- `fetch_execution_url`: Fetch the execution URL for a pipeline execution\n- `list_dashboards`: Lists all available Harness dashboards\n- `get_dashboard_data`: Retrieves the data from a specific Harness dashboard\n\n#### Pipelines Toolset \n\nToolset Name: `pipelines`\n\n- `get_pipeline`: Get details of a specific pipeline\n- `list_pipelines`: List pipelines in a repository\n- `get_execution`: Get details of a specific pipeline execution\n- `list_executions`: List pipeline executions\n- `fetch_execution_url`: Fetch the execution URL for a pipeline execution\n\n#### Connectors Toolset\n\nToolset Name: `connectors`\n\n- `list_connector_catalogue`: List the Harness connector catalogue\n- `get_connector_details`: Get details of a specific connector\n- `list_connectors`: List connectors with filtering options\n\n*Note: Additional toolsets (Pull Requests, Services, Environments, Infrastructure, Repositories, Registries, Dashboards, CCM, Database Operations, Chaos Engineering, SCS, STO, Logs, Templates, IDP, Audit Trail) are available in the full implementation.*\n\n## Prerequisites\n\n1. **Rust 1.75 or later** installed on your system\n2. A Harness API key for authentication\n\n## Quickstart\n\n### Build from Source\n\n1. Clone the repository:\n```bash\ngit clone https://github.com/harness/harness-mcp.git\ncd harness-mcp\n```\n\n2. Build the binary:\n```bash\ncargo build --release\n```\n\n3. Run the server:\n```bash\nHARNESS_PLATFORM_API_KEY=your_api_key \\\nHARNESS_PLATFORM_ORGANIZATION_ID=your_org_id \\\nHARNESS_PLATFORM_PROJECT_ID=your_project_id \\\n./target/release/harness-mcp-server stdio\n```\n\n### Use Docker Image\n\nAlternatively, you can use the pre-built Docker image:\n\n```bash\ndocker run -i --rm \\\n  -e HARNESS_PLATFORM_API_KEY=your_api_key \\\n  -e HARNESS_PLATFORM_ORGANIZATION_ID=your_org_id \\\n  -e HARNESS_PLATFORM_PROJECT_ID=your_project_id \\\n  -e HARNESS_PLATFORM_BASE_URL=your_base_url \\\n  harness/mcp-server:rust stdio\n```\n\n## üõ†Ô∏è Development\n\n### Cargo Commands\n\nThis project uses Cargo for build management:\n\n- `cargo build` ‚Äì Build the project in debug mode\n- `cargo build --release` ‚Äì Build optimized release version\n- `cargo test` ‚Äì Run all tests\n- `cargo test --test e2e` ‚Äì Run end-to-end tests\n- `cargo fmt` ‚Äì Format code\n- `cargo clippy` ‚Äì Run linter\n- `cargo doc --open` ‚Äì Generate and open documentation\n\n### Makefile Usage (Alternative)\n\nA Rust-compatible Makefile is also provided:\n\n- `make build` ‚Äì Build the project\n- `make test` ‚Äì Run tests\n- `make fmt` ‚Äì Format code\n- `make clippy` ‚Äì Run linter\n- `make release` ‚Äì Build release version\n- `make docker-build` ‚Äì Build Docker image\n\n### Command Line Arguments\n\nThe Harness MCP Server supports the following command line arguments:\n\n- `--toolsets`: Comma-separated list of tool groups to enable (default: \"default\")\n- `--enable-license`: Enable license validation and module-based toolset management\n- `--enable-modules`: Comma-separated list of modules to enable (when license is enabled)\n- `--read-only`: Run the server in read-only mode\n- `--log-level`: Set the logging level (trace, debug, info, warn, error)\n- `--version`: Show version information\n- `--help`: Show help message\n- `--base-url`: Base URL for Harness (default: \"https://app.harness.io\")\n\n### Environment Variables\n\nEnvironment variables are prefixed with `HARNESS_PLATFORM_`:\n\n- `HARNESS_PLATFORM_API_KEY`: Harness API key (required)\n- `HARNESS_PLATFORM_ACCOUNT_ID`: Harness account ID (auto-extracted from API key if not provided)\n- `HARNESS_PLATFORM_ORGANIZATION_ID`: Default organization ID (optional)\n- `HARNESS_PLATFORM_PROJECT_ID`: Default project ID (optional)\n- `HARNESS_PLATFORM_BASE_URL`: Base URL for Harness (default: \"https://app.harness.io\")\n- `RUST_LOG`: Set logging level (trace, debug, info, warn, error)\n\n### Authentication\n\nThe server uses a Harness API key for authentication. Set via the `HARNESS_PLATFORM_API_KEY` environment variable.\n\n## Integration with AI Assistants\n\n### Claude Desktop Configuration\n\nOn MacOS: `~/Library/Application\\ Support/Claude/claude_desktop_config.json`  \nOn Windows: `%APPDATA%/Claude/claude_desktop_config.json`\n\n```json\n{\n  \"mcpServers\": {\n    \"harness\": {\n      \"command\": \"/path/to/harness-mcp-server\",\n      \"args\": [\"stdio\"],\n      \"env\": {\n        \"HARNESS_PLATFORM_API_KEY\": \"<YOUR_API_KEY>\",\n        \"HARNESS_PLATFORM_ORGANIZATION_ID\": \"<YOUR_ORG_ID>\",\n        \"HARNESS_PLATFORM_PROJECT_ID\": \"<YOUR_PROJECT_ID>\"\n      }\n    }\n  }\n}\n```\n\n### Usage with Gemini CLI\n\nAdd to `~/.gemini/settings.json`:\n\n```json\n{\n  \"mcpServers\": {\n    \"Harness\": {\n      \"command\": \"/path/to/harness-mcp-server\",\n      \"args\": [\"stdio\"],\n      \"env\": {\n        \"HARNESS_PLATFORM_API_KEY\": \"<YOUR_API_KEY>\",\n        \"HARNESS_PLATFORM_ORGANIZATION_ID\": \"<YOUR_ORG_ID>\",\n        \"HARNESS_PLATFORM_PROJECT_ID\": \"<YOUR_PROJECT_ID>\"\n      }\n    }\n  }\n}\n```\n\n### Cursor Configuration\n\n```json\n{\n  \"mcpServers\": {\n    \"harness\": {\n      \"command\": \"/path/to/harness-mcp-server\",\n      \"args\": [\"stdio\"],\n      \"env\": {\n        \"HARNESS_PLATFORM_API_KEY\": \"your_api_key\",\n        \"HARNESS_PLATFORM_ORGANIZATION_ID\": \"your_org_id\",\n        \"HARNESS_PLATFORM_PROJECT_ID\": \"your_project_id\"\n      }\n    }\n  }\n}\n```\n\n### Docker-based Configuration\n\nFor any AI assistant supporting Docker:\n\n```json\n{\n  \"mcpServers\": {\n    \"harness\": {\n      \"command\": \"docker\",\n      \"args\": [\n        \"run\", \"-i\", \"--rm\",\n        \"-e\", \"HARNESS_PLATFORM_API_KEY\",\n        \"-e\", \"HARNESS_PLATFORM_ORGANIZATION_ID\",\n        \"-e\", \"HARNESS_PLATFORM_PROJECT_ID\",\n        \"harness/mcp-server:rust\",\n        \"stdio\"\n      ],\n      \"env\": {\n        \"HARNESS_PLATFORM_API_KEY\": \"<YOUR_API_KEY>\",\n        \"HARNESS_PLATFORM_ORGANIZATION_ID\": \"<YOUR_ORG_ID>\",\n        \"HARNESS_PLATFORM_PROJECT_ID\": \"<YOUR_PROJECT_ID>\"\n      }\n    }\n  }\n}\n```\n\n## Debugging\n\nSince MCP servers run over stdio, debugging can be challenging. For the best debugging experience, we recommend using the [MCP Inspector](https://github.com/modelcontextprotocol/inspector).\n\n```bash\nnpx @modelcontextprotocol/inspector /path/to/harness-mcp-server stdio\n```\n\nFor Rust-specific debugging:\n\n```bash\n# Enable debug logging\nRUST_LOG=debug ./target/release/harness-mcp-server stdio\n\n# Enable trace logging for maximum verbosity\nRUST_LOG=trace ./target/release/harness-mcp-server stdio\n```\n\n## Testing\n\n### Running Tests\n\n```bash\n# Run all tests\ncargo test\n\n# Run unit tests only\ncargo test --lib\n\n# Run integration tests\ncargo test --test '*'\n\n# Run with output\ncargo test -- --nocapture\n```\n\n### Running E2E Tests\n\nThe project includes end-to-end tests that validate integration with Harness services:\n\n1. Set up required environment variables:\n\n```bash\nexport HARNESS_MCP_SERVER_E2E_TOKEN=<your_harness_api_token>\nexport HARNESS_MCP_SERVER_E2E_ACCOUNT_ID=<your_account_id>\nexport HARNESS_MCP_SERVER_E2E_ORG_ID=<your_org_id>\nexport HARNESS_MCP_SERVER_E2E_PROJECT_ID=<your_project_id>\nexport HARNESS_MCP_SERVER_E2E_BASE_URL=<base_url>\n```\n\n2. Run E2E tests:\n\n```bash\ncargo test --test e2e\n\n# Run specific E2E test\ncargo test --test e2e test_pipeline_workflow\n\n# Run with debug output\nRUST_LOG=debug cargo test --test e2e -- --nocapture\n```\n\n### Test Coverage\n\n```bash\n# Install tarpaulin for coverage\ncargo install cargo-tarpaulin\n\n# Generate coverage report\ncargo tarpaulin --out Html --output-dir coverage\n```\n\n## üîß Performance Optimizations\n\nThe Rust version includes several performance optimizations:\n\n- **Async I/O**: Non-blocking operations using Tokio\n- **Connection Pooling**: Efficient HTTP client with connection reuse\n- **Memory Management**: Zero-copy operations where possible\n- **Compile-time Optimizations**: Link-time optimization (LTO) in release builds\n- **SIMD**: Automatic vectorization for JSON parsing\n\n## üìä Benchmarks\n\nCompared to the Go version:\n- **Startup Time**: ~60% faster\n- **Memory Usage**: ~40% lower\n- **Request Throughput**: ~30% higher\n- **Binary Size**: ~25% smaller (with optimizations)\n\n## üîÑ Migration from Go Version\n\nIf you're migrating from the Go version:\n\n1. **Environment Variables**: Update prefixes from `HARNESS_` to `HARNESS_PLATFORM_`\n2. **Binary Name**: Update paths to point to the Rust binary\n3. **Docker Image**: Use `harness/mcp-server:rust` tag\n4. **Configuration**: No changes needed for MCP client configurations\n5. **API Compatibility**: 100% compatible - no changes to tool interfaces\n\n## ü§ù Contributing\n\nContributions are welcome! Please see our [Contributing Guide](CONTRIBUTING.md) for details.\n\n### Development Setup\n\n1. Install Rust (1.75+)\n2. Clone the repository\n3. Run `cargo build` to verify setup\n4. Run `cargo test` to ensure tests pass\n5. Use `cargo fmt` and `cargo clippy` before submitting PRs\n\n## üìÑ License\n\nThis project is licensed under the Apache License 2.0 - see the [LICENSE](LICENSE) file for details.\n\n## üÜò Support\n\nFor support and questions:\n- üìñ [Documentation](https://docs.harness.io)\n- üí¨ [Community Forum](https://community.harness.io)\n- üêõ [Issue Tracker](https://github.com/harness/harness-mcp/issues)\n- üìß [Support Email](mailto:support@harness.io)\n